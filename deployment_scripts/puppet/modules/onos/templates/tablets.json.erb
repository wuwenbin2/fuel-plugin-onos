<%- index = 1 -%>
<%- key = 1 -%>
{
    "nodes": [
	<%- @controllers_ip.each do |ip| -%>
        <%- if index == @controllers_ip.size -%>
        {
        "ip": "<%= ip %>",
        "id": "<%= ip %>",
        "tcpPort": 9876
        }
        <%- else -%>
        {
        "ip": "<%= ip %>",
        "id": "<%= ip %>",
        "tcpPort": 9876
        },
        <%- end -%>
        <%- index = index + 1 -%>
        <%- end -%>
    	],
        "partitions": {
        <%- @controllers_ip.each do |ip| -%>
        <%- if key == @controllers_ip.size -%>
        "p<%= key -%>":[
	<%- index = 1 -%>
        <%- @controllers_ip.each do |ip| -%>
        <%- if index == @controllers_ip.size -%>
        {
            "ip": "<%= ip %>",
            "id": "<%= ip %>",
            "tcpPort": 9876
        }
        <%- else -%>
        {
            "ip": "<%= ip %>",
            "id": "<%= ip %>",
            "tcpPort": 9876
        },
        <%- end -%>
	<%- index = index + 1 -%>
        <%- end -%>
        ]
        <%- key = key + 1 -%>
        <%- else -%>
        "p<%= key -%>":[
        <%- index = 1 -%>
        <%- @controllers_ip.each do |ip| -%>
        <%- if index ==  @controllers_ip.size -%>
        {
                "ip": "<%= ip %>",
                "id": "<%= ip %>",
                "tcpPort": 9876
        }
        <%- else -%>
        {
                "ip": "<%= ip %>",
                "id": "<%= ip %>",
                "tcpPort": 9876
        },
        <%- end -%>
	<%- index = index + 1 -%>
        <%- end -%>
        ],
        <%- key = key + 1 -%>
        <%- end -%>
        <%- end -%>
}
}
